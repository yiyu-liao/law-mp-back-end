# 一个NodeJs service服务

## 前言

> 最近朋友喊我做一个关于法律平台的小程序，包括front-end/back-end。最近空闲时间比较多，于是答应了下来，也借此机会尝试下进入新领域，毕竟老是写前端业务交互，难免有点腻了。

## 技术选型

既然要做Node服务，脑海中第一时间想到是Koa框架，原因是小而美，轻量，源码也比较通俗易懂，万一遇到什么坑的时候，也可以查阅源码解决。koa的中间件模型，也很好地支持统一封装request错误处理。

其次， 在数据储存方面，选择mysql关系形数据库，引入typeorm提供函数式方法操作数据库，解决了作为一个小前端对数据库这个陌生领域的恐惧。

最后，对于语言的选择，虽然之前自己也有写过一年的typescript的项目，但那时候都是跟着当时的大佬写的，未能领会到正在typescript的魅力。typescript在开发阶段，的确能避免一些低级错误，同时在类型推断方面也提高了不少效率。因此这次很羞耻选择了typescript作为编码语言（你看这个人写的ts怎么和js一摸一样？～～）

## 业务逻辑



### 客户角色

 #### 一、免费咨询

提交表单信息包含：1.问题类别。2.咨询内容。发布后，律师回复后以及评论通过模版消息推送到客户端。

 #### 二、文书起草

提交表单信息发布委托。表单信息如：起草要求，合同证据，可以承受费用，完成时限等。

- 合同审核

- 合同起草

- 代写诉讼

- 发律师函

#### 三、案件委托

提交委托明细

#### 四、 法律顾问

提交顾问需求

#### 五、个人中心

处理需求发布状态，选择律师，取消订单等

- 我的咨询

- 我的文书

- 我的案件

- 我的顾问

- 修改个人信息

- 信息中心

- 申诉服务

接收咨询答复以及服务完成推送提醒。

### 律师角色

#### 一、需求广场

律师报价 => 客户选择 => 支付费用 => 律师服务 => 服务结束 => 上传凭证 => 完成服务 => 客户确认 => 费用到账

- 答疑解惑

- 文书委托

- 案件委托

- 顾问委托

#### 二、个人中心

- 个人信息修改

- 消息中心

接收服务订单以及完成订单

- 与自身相关的抢单服务

提供查阅服务

- 待处理

- 服务中

- 已结束

- 申诉服务


### 管理员角色

处理申诉服务，以及更新小程序展示信息。

## 思考

在做这个项目，主要的时间花在如何整合数据，设计多张表的一对多/多对一，多对多关系等。因为是第一次接触后端项目，在这次mysq表设计方面肯定存在不合理的地方。但到写到这个阶段还是挺有意思的，把东西从无都有一一实现了，在思考的过程中不断进步，这大概就足够了～～


